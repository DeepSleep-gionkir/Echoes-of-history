**[Part 6]**와 **[Part 7]**은 이 기획을 실제로 만질 수 있는 소프트웨어로 변환하는 단계입니다.

1인 개발자가 가장 흔들리기 쉬운 것이 **"어떤 기술을 쓸까?(Tech Stack)"**와 **"어떻게 보여줄까?(UI/UX)"**입니다. 여기서 시간을 낭비하지 않도록, **[가성비 최강 조합]**과 **[모바일 대응 디자인]**을 확정해 드립니다.

---

[Part 6] 기술 아키텍처 (Technical Architecture)

비용 0원, 유지보수 난이도 최하, 하지만 확장성은 무한한 **[1인 개발 표준 스택]**입니다.

6.1. 테크 스택 (The Golden Stack)
구분 기술 (Technology) 선정 이유
Frontend React + Vite 가장 자료가 많고 빌드 속도가 빠름.
3D Engine React Three Fiber (R3F) Three.js를 리액트 컴포넌트(<Box />)처럼 쉽게 사용 가능.
Style Tailwind CSS CSS 파일 왔다 갔다 할 필요 없이 클래스명으로 즉시 디자인.
State Zustand Redux보다 훨씬 코드가 짧고 직관적임.
Backend Node.js (Express) 자바스크립트 하나로 프론트/백엔드 통일.
Realtime Socket.io 채팅, 맵 이동 동기화, 알림 구현의 표준.
Database Supabase DB(Postgres) + Auth(로그인) + Vector(AI) + Realtime을 한 방에 해결.
AI Gemini 2.5 Flash-Lite 구글 AI Studio를 통한 무료/저가 API 사용.
6.2. 데이터베이스 스키마 설계 (Supabase)

이대로 SQL Editor에 복사해 넣으면 DB가 완성되는 핵심 테이블 구조입니다.

1. users (국가 및 기초 자원)

code
SQL
download
content_copy
expand_less
CREATE TABLE users (
id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
username TEXT NOT NULL,
authority_tier TEXT DEFAULT 'ignored', -- 'ignored', 'normal', 'revered'
resources JSONB DEFAULT '{"gold": 100, "food": 100, "mat": 50, "man": 50, "know": 0, "auth": 0}',
reputation_tags JSONB DEFAULT '[]', -- ["warmonger", "pacifist"]
last_active TIMESTAMP DEFAULT NOW()
);

2. inventory (무한 확장 자원)

code
SQL
download
content_copy
expand_less
CREATE TABLE inventory (
id BIGSERIAL PRIMARY KEY,
user_id UUID REFERENCES users(id),
item_name TEXT NOT NULL, -- "철", "비단", "이상한 버섯"
amount INT DEFAULT 0,
tags JSONB -- ["luxury", "strategic"]
);

3. internal_entities (만능 엔티티)

code
SQL
download
content_copy
expand_less
CREATE TABLE internal_entities (
id BIGSERIAL PRIMARY KEY,
user_id UUID REFERENCES users(id),
name TEXT, -- "동인도 회사"
type TEXT, -- "faction", "corp", "military"
tags JSONB, -- ["merchant", "greedy"]
loyalty INT DEFAULT 50,
power INT DEFAULT 50
);
6.3. API 비용 방어 아키텍처 (The Gateway)

클라이언트가 직접 AI를 호출하게 두면 해킹당하거나 요금 폭탄을 맞습니다. 반드시 Node.js 서버가 문지기(Gateway) 역할을 해야 합니다.

Request: 클라이언트가 socket.emit('chat', msg) 전송.

Filter (Server):

유저의 행동력(Stamina) 확인. (없으면 거절)

입력 텍스트 길이 제한 확인.

Cache Check (Server):

"이 질문에 대한 답이 DB에 있는가?" (Vector Search).

있으면 DB 값 반환 (비용 0원).

AI Call (Server -> Google):

캐시가 없을 때만 Gemini 호출.

Flash-Lite 모델 사용 & JSON Mode 강제.

Response: 결과 전송 및 DB 저장.

[Part 7] UX/UI 디자인 (Interface Design)

모바일에서도 쾌적하게 플레이할 수 있는 [반응형 전술가 태블릿] 컨셉입니다.

7.1. 레이아웃 (Layout Strategy)

화면을 크게 **3개 층(Layer)**으로 나눕니다.

Layer 1 (Background): 3D Map

화면 전체(100vw, 100vh)를 차지합니다.

터치/드래그로 맵을 이동하고 확대합니다.

Layer 2 (HUD): Information

Top Bar: 자원 6종(아이콘+숫자)이 일렬로 나열됨. 모바일에서는 가로 스크롤 가능.

Bottom Ticker: 뉴스 속보가 한 줄로 흘러감.

Layer 3 (Panel): Interaction

PC: 우측에 고정된 사이드바 (너비 400px).

Mobile: 평소엔 숨겨져 있다가, 하단 버튼을 누르면 올라오는 [바텀 시트 (Bottom Sheet)] 형태.

7.2. 조작 UX (Interaction Flow)
① 육각형 타일 메뉴 (Radial Menu)

타일을 클릭했을 때 화면을 가리는 큰 창을 띄우지 않고, 타일 주변에 둥글게 버튼을 띄웁니다.

구성: [이동], [건설], [정보], [관리] 아이콘 4개.

장점: 마우스/손가락 동선을 최소화합니다.

② 탭 분리: [국정] vs [회의]

우측 패널(또는 바텀 시트)은 명확하게 두 개의 탭으로 나뉩니다.

Tab A: 국정 (Actions) - "왕의 집무실"

디자인: 깔끔한 버튼 그리드.

기능: [징병], [연구], [법안] 등 즉시 실행되는 시스템 버튼들.

특징: AI 개입 없음. 빠름.

Tab B: 회의 (Council) - "알현실"

디자인: 카카오톡 같은 채팅 UI.

기능:

내부 파벌 리더들과의 대화 ("상인 대표: 세금 좀 깎아주시오").

외교 사절과의 대화.

특징: AI가 생성한 텍스트가 올라옴. 서사적임.

③ 결재 모달 (The Sanction Modal)

유저가 가장 많이 보게 될 화면입니다.

디자인 컨셉: 낡은 양피지 위에 타자기로 친 듯한 글씨체.

색상 코딩:

안전한 제안: 푸른색 인장.

위험한 제안(폭동 경고): 붉은색 인장 + 흔들리는 애니메이션.

버튼: 단순 '확인'이 아니라 [옥새 찍기] 아이콘을 눌러야 함 (타격감 부여).

7.3. 개발 체크리스트 (To-Do)

1. 환경 설정 (Phase 1)

npm create vite@latest로 리액트 프로젝트 생성.

npm install @react-three/fiber @react-three/drei three zustand 설치.

2. UI 컴포넌트 제작 (Phase 4)

ResourceManager: 상단에 자원 아이콘과 숫자를 표시하는 컴포넌트. (숫자가 바뀔 때 카운팅 애니메이션 적용)

ActionPanel: 우측 사이드바/바텀 시트 컴포넌트. (Tailwind의 md:w-96 w-full 클래스로 반응형 처리)

SanctionModal: z-index를 가장 높게 설정하여 화면 중앙에 뜨는 결재창 구현.

3. 3D 인터랙션

TileClick: R3F의 onClick 이벤트를 사용하여, 클릭된 타일 좌표를 State에 저장하고 Radial Menu를 띄우는 로직.

---
